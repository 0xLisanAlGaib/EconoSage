type = "directrequest"
schemaVersion = 1
name = "Get US GDP Quarterly Growth"
maxTaskDuration = "0s"
contractAddress = ""
minIncomingConfirmations = 0
observationSource = """
    decode_log   [type="ethabidecodelog"
                 abi="OracleRequest(bytes32 indexed specId, address requester, bytes32 requestId, string callbackFuncStr, uint256 cancelExpiration, uint256 dataVersion, bytes data)"
                 data="$(jobRun.logData)"
                 topics="$(jobRun.logTopics)"]

    fred_bridge  [type="bridge" name="fred-gdp"]

    parse        [type="jsonparse" path="result,value" data="$(fred_bridge)"]
    
    encode_data  [type="ethabiencode"
                 abi="(bytes32 requestId, int256 growthRate, uint8 quarter, uint16 year)"
                 data="{ \\"requestId\\": $(decode_log.requestId), \\"growthRate\\": $(parse), \\"quarter\\": 1, \\"year\\": 2024 }"]

    encode_tx    [type="ethabiencode"
                 abi="fulfillOracleRequest(bytes32 requestId, uint256 payment, address callbackAddr, bytes4 callbackFunctionId, uint256 expiration, bytes32 data)"
                 data="{\\"requestId\\": $(decode_log.requestId), \\"payment\\": $(decode_log.payment), \\"callbackAddr\\": $(decode_log.requester), \\"callbackFunctionId\\": $(decode_log.functionSelector), \\"expiration\\": $(decode_log.cancelExpiration), \\"data\\": $(encode_data)}"]

    submit_tx    [type="ethtx" to="YOUR-ORACLE-CONTRACT-ADDRESS" data="$(encode_tx)"]

    decode_log -> fred_bridge -> parse -> encode_data -> encode_tx -> submit_tx
"""